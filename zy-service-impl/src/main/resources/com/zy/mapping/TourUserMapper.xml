<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zy.mapper.TourUserMapper" >

	<resultMap id="baseResultMap" type="com.zy.entity.tour.TourUser">
		<id column="id" property="id" />
		<result column="tour_time_id" property="tourTimeId" />
		<result column="tour_id" property="tourId" />
		<result column="user_id" property="userId" />
		<result column="parent_id" property="parentId" />
		<result column="sequence_id" property="sequenceId" />
		<result column="create_date" property="createDate" />
		<result column="update_date" property="updateDate" />
		<result column="update_by" property="updateBy" />
		<result column="is_effect" property="isEffect" />
		<result column="audit_status" property="auditStatus" />
		<result column="report_id" property="reportId" />
		<result column="is_transfers" property="isTransfers" />
		<result column="car_number" property="carNumber" />
		<result column="plan_time" property="planTime" />
		<result column="car_images" property="carImages" />
		<result column="user_remark" property="userRemark" />
		<result column="reviewe_remark" property="revieweRemark" />
		<result column="house_type" property="houseType" />
		<result column="is_add_bed" property="isAddBed" />
	</resultMap>

	<sql id="baseColumn">
		id,
		tour_time_id,
		tour_id,
		user_id,
		parent_id,
		sequence_id,
		create_date,
		update_date,
		update_by,
		is_effect,
		audit_status,
		report_id,
		is_transfers,
		car_number,
		plan_time,
		car_images,
		user_remark,
		reviewe_remark,
		house_type,
		is_add_bed
	</sql>

	<!-- 查询所有旅客信息 -->
	<select id="findAll" resultMap="baseResultMap" parameterType="com.zy.model.query.TourUserQueryModel">
		SELECT
		<include refid="baseColumn"/>
		FROM ts_tour_user
		<where>
			<if test="updateTime !=null">
				and update_date = #{updateTime},
			</if>
			<if test="updateTime !=null">
				and create_date = #{createdTime},
			</if>
		</where>
		ORDER BY create_date DESC ,  audit_status ASC
		<if test="offset != null">
			limit #{offset}, #{pageSize}
		</if>
	</select>

	<select id="count" resultType="_long" parameterType="com.zy.model.query.TourUserQueryModel">
		SELECT
		count(*)
		FROM ts_tour_user
		<where>
			<if test="updateTime !=null">
				and update_date = #{updateTime},
			</if>
			<if test="updateTime !=null">
				and create_date = #{createdTime},
			</if>
		</where>
	</select>


	<!-- 查询旅客信息 -->
	<select id="findOne" resultMap="baseResultMap" parameterType="long">
		SELECT
			<include refid="baseColumn"/>
		FROM ts_tour_user a
		WHERE
			a.id = #{id}
	</select>




	<insert id="insert" parameterType="com.zy.entity.usr.Tag" useGeneratedKeys="true" keyProperty="id">
		insert into `ts_tour` (title,brief,days,is_released,images,content,create_date,create_by,del_fage)
		values (#{title},#{brief},#{days},#{isReleased},#{image},#{content},#{createdTime},#{createby},#{delfage})
	</insert>

	<delete id="delete">
		delete from `ts_tour` where id = #{id}
	</delete>

	<!-- 审核状态 -->
	<update id="updateAuditStatus" parameterType="com.zy.entity.tour.TourUser">
		update ts_tour_user
		<set>
			<if test="auditStatus !=null">
				audit_status = #{auditStatus},
			</if>
			<if test="revieweRemark !=null">
				reviewe_remark = #{revieweRemark},
			</if>
			<if test="updateDate !=null">
				update_date = #{updateDate},
			</if>
			<if test="updateBy !=null">
				update_by = #{updateBy}
			</if>
		</set>
		where id = #{id}
	</update>



</mapper>





